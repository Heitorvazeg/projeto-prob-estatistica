---
title: "**Análise Estatística: Como a Renda dos indivíduos varia segundo escolaridade, ocupação, idade e sexo: Uma Análise Regional Comparada com Dados da PNAD Contínua 2022**"
subtitle: "Engenharia de Software - Probabilidade e Estatística - 2025.2"
author: |
  | Finéias Antônio
  | Gustavo Henrique
  | Heitor M Augusto Vaz
  | Túlio Vitorette
  | Wallison Fagundes
output: 
  pdf_document:
    latex_engine: pdflatex
    number_sections: true
---

```{r setup, include=FALSE}
library(knitr)
library(dplyr)
library(ggplot2)
library(tidyr)

df <- readRDS("data/clean/pnad_2022_q4_clean.rds")

# Configuração global
knitr::opts_chunk$set(echo = FALSE, fig.align = "center", out.width = "75%", warning = FALSE, message = FALSE)
```

# Introdução

A renda individual é resultado da interação entre características pessoais, fatores produtivos e condições estruturais dos mercados de trabalho. A literatura econômica — tanto a macroeconômica apresentada por Snowdon e Vane quanto os manuais clássicos de Economia do Trabalho — destaca que escolaridade, experiência, inserção ocupacional e diferenças demográficas influenciam diretamente a produtividade e, consequentemente, os salários.

Além desses fatores, características como sexo e região também impactam significativamente os rendimentos, refletindo desigualdades persistentes no acesso a oportunidades no mercado de trabalho. Nesse contexto, compreender como a renda varia segundo escolaridade, ocupação, idade, sexo e região é essencial para avaliar desigualdades socioeconômicas e identificar grupos que enfrentam maiores barreiras.

Utilizando os microdados da PNAD Contínua 2022, este estudo conduz uma análise estatística comparada, visando evidenciar os determinantes da renda e como eles se manifestam de forma distinta entre regiões e perfis populacionais.

# Objetivos

## Objetivo Geral
Avaliar como a renda individual varia segundo escolaridade, ocupação, idade, sexo e região, utilizando dados da PNAD Contínua 2022.

## Objetivos Específicos
- Descrever características socioeconômicas da população brasileira.
- Investigar como variáveis pessoais e laborais influenciam a renda.
- Comparar diferenças regionais nos determinantes da renda.
- Visualizar padrões por meio de gráficos estatísticos.
- Ajustar um modelo de regressão para explicar a renda individual.

# Descrição dos Dados

## Fonte
Os dados utilizados são provenientes da **Pesquisa Nacional por Amostra de Domicílios Contínua (PNAD Contínua 2022)**, disponibilizada pelo IBGE. A base inclui informações demográficas, educacionais, ocupacionais e de rendimento, coletadas trimestralmente.

## Variáveis Utilizadas
As principais variáveis selecionadas para análise foram:

- **UF** — Unidade Federativa  
- **Sexo (V2007)**  
- **Idade (V2009)**  
- **Nível de Escolaridade (V3002 / VD3004 recodificada)**  
- **Condição Ocupacional (VD4002)**  
- **Setor/Grupo Ocupacional (VD4012 ou VD4010)**  
- **Horas Semanais Trabalhadas (VD4015/VD4019)**  
- **Rendimento do Trabalho (VD4030 ou VD4010)**  
- **Região - derivada da UF**
- **Faixa Idade - Derivada da Idade**
- **Anos de Estudo (VD3006)**

# Tratamento e Limpeza de Dados

- **Seleção das variáveis relevantes:** foram extraídas apenas as informações necessárias para atender aos objetivos da análise.
- **Recodificação de variáveis categóricas:** escolaridade, ocupação e condição de trabalho foram reorganizadas em categorias analíticas.
- **Criação de faixas:** foram criadas categorias de idade (ex.: 18–29, 30–44, 45–59, 60+) e escolaridade (Fundamental, Médio, Superior etc.).
- **Tratamento de valores faltantes:** observações com informações ausentes ou inconsistentes foram analisadas e tratadas com base no contexto da variável (remoção ou recodificação).

# Análise Descritiva.
## Perfil Populacional.
```{r fig.align="center", fig.width=10, fig.height=7}
# Criar df_plot corretamente

library(dplyr)
library(ggplot2)
library(scales)

df_plot <- bind_rows(
  df %>%
    count(Sexo) %>%
    mutate(Prop = n / sum(n), Categoria = Sexo, Variavel = "Sexo"),

  df %>%
    count(Faixa_Idade) %>%
    mutate(Prop = n / sum(n), Categoria = Faixa_Idade, Variavel = "Faixa Etária"),

  df %>%
    count(Grau_instrucao) %>%
    mutate(Prop = n / sum(n), Categoria = Grau_instrucao, Variavel = "Escolaridade"),
  
  df %>%
    count(Faixa_Anos_Estudo) %>%
    mutate(Prop = n / sum(n), Categoria = Faixa_Anos_Estudo, Variavel = "Anos de Estudo"),

  df %>%
    count(Faixa_Horas_Trabalho) %>%
    mutate(Prop = n / sum(n), Categoria = Faixa_Horas_Trabalho, Variavel = "Horas Trabalhadas"),

  df %>%
    count(Regiao) %>%
    mutate(Prop = n / sum(n), Categoria = Regiao, Variavel = "Região")
)

df_plot$Categoria <- as.character(df_plot$Categoria)
df_plot$Variavel <- factor(df_plot$Variavel, 
                           levels = c("Sexo","Faixa Etária","Escolaridade","Anos de Estudo","Horas Trabalhadas","Região"))

ggplot(df_plot, aes(x = Prop, y = reorder(Categoria, Prop))) +
  geom_col(fill = "#34495e", width = 0.7) +
  geom_text(aes(label = percent(Prop, accuracy = 0.1)),
            hjust = -0.1, size = 3.5) +
  facet_wrap(~ Variavel, scales = "free_y", ncol = 2) +
  scale_x_continuous(labels = percent_format(),
                     expand = expansion(mult = c(0, 0.2))) +
  labs(
    title = "Perfil Demográfico e Socioeconômico",
    x = NULL, y = NULL
  ) +
  theme_minimal(base_size = 13) +
  theme(
    strip.text = element_text(face = "bold"),
    plot.title = element_text(size = 15, face = "bold", hjust = 0.5)
  )

```

# Relação entre Renda e os Determinantes Individuais.
## Renda por Escolaridade.
```{r fig.align="center", fig.width=8, fig.height=5}
library(ggplot2)
library(RColorBrewer)

ggplot(df, aes(x = as.factor(Grau_instrucao), y = Rendimento, fill = as.factor(Grau_instrucao))) +
  geom_boxplot(alpha = 0.8) +
  scale_fill_brewer(palette = "Set2") +  # Paleta mais suave e moderna
  labs(
    title = "Renda por Escolaridade",
    x = "Escolaridade",
    y = "Renda (R$)"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face="bold", hjust=0.5),
    axis.text.x = element_text(angle=45, hjust=1),
    legend.position = "none"  # remove a legenda se quiser
  )

```
## Renda por Ocupação.
```{r fig.align="center", fig.width=8, fig.height=5}
library(ggplot2)
library(RColorBrewer)

df$Cat_ocup <- as.factor(df$Cat_ocup)

ggplot(df, aes(x = Cat_ocup, y = Rendimento, fill = Cat_ocup)) +
  geom_boxplot(alpha = 0.8) +
  scale_fill_brewer(palette = "Set2") +  # paleta suave e harmoniosa
  labs(
    title = "Renda por Ocupação",
    x = "Ocupação",
    y = "Renda (R$)"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5),
    axis.text.x = element_text(size = 12, angle = 25, hjust = 1),
    legend.position = "none"  # remove legenda se quiser
  )
```
## Renda por Renda por Idade.
```{r fig.align="center", fig.width=8, fig.height=5}
library(ggplot2)
library(RColorBrewer)

ggplot(df, aes(x = Faixa_Idade, y = Rendimento, fill = Faixa_Idade)) +
  geom_boxplot(alpha = 0.8) +
  scale_fill_brewer(palette = "Pastel1") +  # cores suaves e harmoniosas
  labs(
    title = "Renda por Idade",
    x = "Faixa Etária",
    y = "Renda (R$)"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face="bold", hjust=0.5),
    legend.position = "none"  # remove legenda se quiser
  )

```
## Renda por Sexo.
```{r fig.align="center", fig.width=8, fig.height=5}
ggplot(df, aes(x = Sexo, y = Rendimento, fill = Sexo)) +
stat_summary(fun = mean, geom = "col", alpha = 0.75, show.legend = FALSE) +
labs(
title = "Renda Média por Sexo",
x = "Sexo",
y = "Renda (R$)"
) +
theme_minimal(base_size = 13) +
theme(
plot.title = element_text(face = "bold", hjust = 0.5)
)

```

# Análise Comparada entre Regiões.
## Renda Média por Região
```{r fig.align="center", fig.width=8, fig.height=5}
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library(scales)  # para scales::dollar

df %>%
  group_by(Regiao) %>%
  summarise(Renda_Media = mean(Rendimento, na.rm = TRUE)) %>%
  ggplot(aes(x = Regiao, y = Renda_Media, fill = Regiao)) +
  geom_col(alpha = 0.8) +
  geom_text(aes(label = scales::dollar(Renda_Media, prefix="R$ ", accuracy = 1)),
            vjust = -0.5, size = 4) +
  scale_fill_brewer(palette = "Set2") +  # paleta harmoniosa
  labs(
    title = "Renda Média por Região",
    x = "Região",
    y = "Renda Média (R$)"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face="bold", hjust=0.5),
    legend.position = "none"  # remove legenda se quiser
  )
```
## Renda Média por Escolaridade em Cada Região.
```{r fig.align="center", fig.width=8, fig.height=5}
library(dplyr)
library(ggplot2)
library(RColorBrewer)

# Garantir que é character
df <- df %>%
  mutate(Grau_instrucao = as.character(Grau_instrucao),
         Grau_instrucao_curto = case_when(
           Grau_instrucao %in% c("Sem instrução", "Menos de 1 ano de estudo ou sem instrução") ~ "Sem instrução",
           Grau_instrucao == "Fundamental Incompleto" ~ "Fundamental Inc.",
           Grau_instrucao == "Fundamental Completo" ~ "Fundamental Comp.",
           Grau_instrucao == "Médio Incompleto" ~ "Médio Inc.",
           Grau_instrucao == "Médio Completo" ~ "Médio Comp.",
           Grau_instrucao == "Superior Incompleto" ~ "Superior Inc.",
           Grau_instrucao == "Superior Completo" ~ "Superior Comp.",
           TRUE ~ Grau_instrucao
         ))

# Gráfico
ggplot(df, aes(x = Grau_instrucao_curto, y = Rendimento, fill = Grau_instrucao_curto)) +
  geom_boxplot(alpha = 0.8, outlier.size = 0.8) +
  facet_wrap(~Regiao, scales = "free_x") +
  scale_fill_brewer(palette = "Set3") +
  labs(
    title = "Renda por Escolaridade em Cada Região",
    x = "Escolaridade",
    y = "Renda (R$)"
  ) +
  theme_minimal(base_size = 11) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "none",
    plot.title = element_text(face="bold", hjust=0.5)
  )


```

## Renda Média por Ocupação em cada Região
```{r renda_ocupacao_regiao, warning=FALSE, message=FALSE, fig.width=10, fig.height=5}

library(ggplot2)
library(dplyr)
library(scales)
library(RColorBrewer)
library(grid)  # para unit()

# Agrupar e calcular renda média
df_renda_ocup <- df %>%
  filter(!is.na(Cat_ocup), !is.na(Rendimento), !is.na(Regiao)) %>%
  group_by(Regiao, Cat_ocup) %>%
  summarise(Renda_Media = mean(Rendimento, na.rm = TRUE), .groups="drop")

# Plot ajustado
ggplot(df_renda_ocup, aes(x = Renda_Media, y = reorder(Cat_ocup, Renda_Media), fill = Cat_ocup)) +
  geom_col(alpha = 0.85, show.legend = FALSE) +  # remove legenda desnecessária
  facet_wrap(~ Regiao, nrow = 1, scales = "free_y") +  # escala y livre por região
  scale_fill_brewer(palette = "Set2") +
  scale_x_continuous(labels = scales::comma, expand = expansion(mult = c(0, 0.05))) +
  labs(
    title = "Renda Média por Ocupação em Cada Região",
    subtitle = "Valores estimados com base na PNAD Contínua",
    x = "Renda Média (R$)",
    y = "Categoria Ocupacional"
  ) +
  theme_minimal(base_size = 11) +
  theme(
    strip.text = element_text(face = "bold", size = 11),
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
    plot.subtitle = element_text(size = 12, hjust = 0.5),
    axis.text.y = element_text(size = 9),
    axis.text.x = element_text(size = 9),
    panel.spacing = unit(1.5, "lines"),
    legend.position = "none"
  )

```

## Renda Média por Faixa Etária em cada Região
```{r renda_faixa_idade_regiao, fig.align="center", fig.width=8, fig.height=4, warning=FALSE, message=FALSE}

library(ggplot2)
library(dplyr)
library(RColorBrewer)

df_plot <- df %>%
  filter(!is.na(Faixa_Idade), !is.na(Rendimento), !is.na(Regiao))

ggplot(df_plot, aes(x = Faixa_Idade, y = Rendimento, fill = Faixa_Idade)) +
  geom_boxplot(alpha = 0.8, outlier.alpha = 0.25) +
  facet_wrap(~ Regiao, nrow = 1) +
  scale_fill_brewer(palette = "Pastel1") +  # cores suaves e harmoniosas
  labs(
    title = "Distribuição da Renda por Faixa Etária nas Regiões do Brasil",
    x = "Faixa Etária",
    y = "Renda (R$)"
  ) +
  theme_minimal(base_size = 11) +
  theme(
    plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
    strip.text = element_text(face = "bold"),
    axis.text.x = element_text(angle = 25, hjust = 1),
    panel.spacing = unit(1, "lines"),
    legend.position = "none"  # remove legenda se quiser
  )

```

## Renda Média por Sexo em cada Região.
```{r renda_sexo_regiao, warning=FALSE, message=FALSE}

library(dplyr)
library(ggplot2)
library(scales)

df_renda_sexo_regiao <- df %>%
  filter(!is.na(Sexo), !is.na(Rendimento), !is.na(Regiao)) %>%
  group_by(Regiao, Sexo) %>%
  summarise(Renda_Media = mean(Rendimento, na.rm = TRUE), .groups = "drop")

ggplot(df_renda_sexo_regiao,
       aes(x = Regiao, y = Renda_Media, fill = Sexo)) +
  geom_col(position = position_dodge(width = 0.7), width = 0.6) +
  geom_text(aes(label = comma(Renda_Media, accuracy = 1)),
            position = position_dodge(width = 0.7),
            vjust = -0.4, size = 3.5) +
  scale_y_continuous(labels = comma,
                     expand = expansion(mult = c(0, 0.1))) +
  labs(
    title = "Renda Média por Sexo e Região",
    subtitle = "PNAD Contínua 2022",
    x = "Região",
    y = "Renda Média (R$)",
    fill = "Sexo"
  ) +
  scale_fill_manual(values = c("#2c3e50", "#dbd2cbff")) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    plot.subtitle = element_text(size = 12)
  )
```

# Regressão Linear

A escolaridade é amplamente reconhecida como um dos principais determinantes da renda, conforme discutido na literatura econômica do capital humano. Indivíduos com maior nível de instrução tendem a apresentar maior produtividade, o que se reflete em salários mais elevados. Para verificar empiricamente essa relação utilizando os microdados da PNAD Contínua 2022, estimamos uma regressão linear simples em que o rendimento individual é explicado apenas pela escolaridade.

## Modelo Sugerido

## Gráfico da Regressão Linear

``` {r GraficoRegressaoLinear, fig.width=10, fig.height=6, warning=FALSE, message=FALSE}
library(tidyverse)
library(readr)
cor_pontos <- "grey40"
y_lim <- quantile(df$Rendimento, 0.99, na.rm = TRUE)


ggplot(data = df, aes(x = Anos_estudo, y = Rendimento)) +
  
  geom_jitter(
    data = df %>% sample_n(2500), 
    width = 0.49,   
    alpha = 0.4,   
    size = 1.0,
    color = "grey40"
  ) +
  geom_smooth(method = "lm", color = "black", se = TRUE) +
  coord_cartesian(ylim = c(0, y_lim)) +
  labs(
    title = "Regressão Linear: Rendimento vs. Anos de Estudo",
    x = "Anos de Estudo",
    y = "Rendimento (R$)",
    caption = "Dados: PNAD Contínua 2022 Q4"
  ) +
  theme_bw() +
  
  theme(
    plot.title = element_text(size = 18, face = "bold", hjust = 0.5), 
    axis.title.x = element_text(size = 12, face = "bold"),
    axis.title.y = element_text(size = 12, face = "bold"),
    axis.text = element_text(size = 10),
    panel.grid.minor = element_blank(),
    panel.background = element_rect(fill = "grey98") 
  )
```

## Interpretação

Os resultados indicam que existe uma relação positiva entre escolaridade e renda: conforme o nível educacional aumenta, o rendimento médio tende a crescer. O coeficiente estimado no modelo linear mostra o aumento esperado no rendimento para cada avanço de nível educacional. Além disso, a significância estatística dos parâmetros confirma que a escolaridade exerce efeito relevante sobre o rendimento individual.

O gráfico reforça essa conclusão ao evidenciar a tendência crescente da linha de regressão, apesar da variabilidade natural observada entre indivíduos de um mesmo nível educacional.

# Conclusão

A análise da PNAD Contínua 2022 mostrou que a renda individual varia de forma consistente com características pessoais e estruturais, como escolaridade, ocupação, idade, sexo e região. Os gráficos e estatísticas revelaram desigualdades claras entre diferentes perfis populacionais e regiões do país. A regressão linear simples confirmou que níveis mais altos de escolaridade estão associados a rendimentos maiores, reforçando o papel da educação na redução das desigualdades. Em conjunto, essas análises evidenciam a importância de políticas públicas que ampliem oportunidades educacionais e laborais, promovendo maior equidade socioeconômica no Brasil.
